(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[120],{71120:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>D});var r=a(37703),s=a(14890),o=a(17214),l=a(87271),i=a(74935),n=a(45697),p=a.n(n),m=(a(33948),a(60285),a(64765),a(4723),a(67294)),c=a(5977),d=a(16406),u=a(96512),h=a(44012),w=a(85163),f=a(78274),E=a(82251),g=a(927);function _(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class b extends m.PureComponent{constructor(e){super(e),_(this,"submit",(e=>{e.preventDefault();const t={},a=this.passwordInput.current.value;if(!a)return t.error=i._u("claim.oauth_to_email.enterPwd","Please enter a password."),void this.setState(t);const{valid:r,error:s}=i.eW(a,this.props.passwordConfig);if(!r&&s)return void this.setState({error:s});const o=this.passwordConfirmInput.current.value;if(!o||a!==o)return t.error=i._u("claim.oauth_to_email.pwdNotMatch","Passwords do not match."),void this.setState(t);t.error=null,this.setState(t),(0,w.wg)(this.props.currentType,this.props.email,a,(e=>{e.follow_link&&(window.location.href=e.follow_link)}),(e=>{this.setState({error:e.message})}))})),this.state={},this.passwordInput=m.createRef(),this.passwordConfirmInput=m.createRef()}render(){var e=null;this.state.error&&(e=m.createElement("div",{className:"form-group has-error"},m.createElement("label",{className:"control-label"},this.state.error)));var t="form-group";e&&(t+=" has-error");const a="".concat(this.props.currentType===f.ZP.SAML_SERVICE?f.ZP.SAML_SERVICE.toUpperCase():i.cv(this.props.currentType)," SSO");return m.createElement("div",null,m.createElement("h3",null,m.createElement(h.Z,{id:"claim.oauth_to_email.title",defaultMessage:"Switch {type} Account to Email",values:{type:a}})),m.createElement("form",{onSubmit:this.submit},m.createElement("p",null,m.createElement(h.Z,{id:"claim.oauth_to_email.description",defaultMessage:"Upon changing your account type, you will only be able to login with your email and password."})),m.createElement("p",null,m.createElement(h.Z,{id:"claim.oauth_to_email.enterNewPwd",defaultMessage:"Enter a new password for your {site} email account",values:{site:this.props.siteName}})),m.createElement("div",{className:t},m.createElement(g.Z,{type:"password",className:"form-control",name:"password",ref:this.passwordInput,placeholder:{id:(0,E.t)("claim.oauth_to_email.newPwd"),defaultMessage:"New Password"},spellCheck:"false"})),m.createElement("div",{className:t},m.createElement(g.Z,{type:"password",className:"form-control",name:"passwordconfirm",ref:this.passwordConfirmInput,placeholder:{id:(0,E.t)("claim.oauth_to_email.confirm"),defaultMessage:"Confirm Password"},spellCheck:"false"})),e,m.createElement("button",{type:"submit",className:"btn btn-primary"},m.createElement(h.Z,{id:"claim.oauth_to_email.switchTo",defaultMessage:"Switch {type} to Email and Password",values:{type:a}}))))}}_(b,"propTypes",{currentType:p().string,email:p().string,siteName:p().string,passwordConfig:p().object});var v=a(6125);function P(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class y extends m.PureComponent{constructor(e){super(e),P(this,"preSubmit",(e=>{e.preventDefault();var t={},a=this.passwordInput.current.value;if(!a)return t.error=i._u("claim.email_to_oauth.pwdError","Please enter your password."),void this.setState(t);this.setState({password:a}),t.error=null,this.setState(t),this.submit(this.props.email,a,"")})),P(this,"submit",((e,t,a)=>{(0,w.go)(e,t,a,this.props.newType,(e=>{e.follow_link&&(window.location.href=e.follow_link)}),(e=>{this.state.showMfa||"mfa.validate_token.authenticate.app_error"!==e.server_error_id?this.setState({error:e.message,showMfa:!1}):this.setState({showMfa:!0})}))})),this.state={showMfa:!1,password:""},this.passwordInput=m.createRef()}render(){var e=null;this.state.error&&(e=m.createElement("div",{className:"form-group has-error"},m.createElement("label",{className:"control-label"},this.state.error)));var t="form-group";e&&(t+=" has-error");const a=this.props.newType===f.ZP.SAML_SERVICE?f.ZP.SAML_SERVICE.toUpperCase():i.cv(this.props.newType),r="".concat(a," SSO");let s;return s=this.state.showMfa?m.createElement(v.Z,{loginId:this.props.email,password:this.state.password,submit:this.submit}):m.createElement("form",{onSubmit:this.preSubmit},m.createElement("p",null,m.createElement(h.Z,{id:"claim.email_to_oauth.ssoType",defaultMessage:"Upon claiming your account, you will only be able to login with {type} SSO",values:{type:a}})),m.createElement("p",null,m.createElement(h.Z,{id:"claim.email_to_oauth.ssoNote",defaultMessage:"You must already have a valid {type} account",values:{type:a}})),m.createElement("p",null,m.createElement(h.Z,{id:"claim.email_to_oauth.enterPwd",defaultMessage:"Enter the password for your {site} account",values:{site:this.props.siteName}})),m.createElement("div",{className:t},m.createElement(g.Z,{type:"password",className:"form-control",name:"password",ref:this.passwordInput,placeholder:{id:(0,E.t)("claim.email_to_oauth.pwd"),defaultMessage:"Password"},spellCheck:"false"})),e,m.createElement("button",{type:"submit",className:"btn btn-primary"},m.createElement(h.Z,{id:"claim.email_to_oauth.switchTo",defaultMessage:"Switch Account to {uiType}",values:{uiType:r}}))),m.createElement("div",null,m.createElement("h3",null,m.createElement(h.Z,{id:"claim.email_to_oauth.title",defaultMessage:"Switch Email/Password Account to {uiType}",values:{uiType:r}})),s)}}function N(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}P(y,"propTypes",{newType:p().string,email:p().string,siteName:p().string}),a(23157);class S extends m.PureComponent{constructor(e){super(e),N(this,"preSubmit",(e=>{e.preventDefault();var t={passwordError:"",confirmError:"",ldapPasswordError:"",serverError:""};const a=this.ldapPasswordInput.current.value;if(!a)return t.ldapPasswordError=i._u("claim.ldap_to_email.ldapPasswordError","Please enter your AD/LDAP password."),void this.setState(t);const r=this.passwordInput.current.value;if(!r)return t.passwordError=i._u("claim.ldap_to_email.pwdError","Please enter your password."),void this.setState(t);const{valid:s,error:o}=i.eW(r,this.props.passwordConfig);if(!s&&o)return void this.setState({passwordError:o});const l=this.passwordConfirmInput.current.value;if(!l||r!==l)return t.confirmError=i._u("claim.ldap_to_email.pwdNotMatch","Passwords do not match."),void this.setState(t);t.password=r,t.ldapPassword=a,this.setState(t),this.submit(this.props.email,r,"",a)})),N(this,"submit",((e,t,a,r)=>{this.props.switchLdapToEmail(r||this.state.ldapPassword,this.props.email,t,a).then((({data:e,error:t})=>{e&&e.follow_link?window.location.href=e.follow_link:t&&(t.server_error_id.startsWith("model.user.is_valid.pwd")?this.setState({passwordError:t.message,showMfa:!1}):"ent.ldap.do_login.invalid_password.app_error"===t.server_error_id?this.setState({ldapPasswordError:t.message,showMfa:!1}):this.state.showMfa||"mfa.validate_token.authenticate.app_error"!==t.server_error_id?this.setState({serverError:t.message,showMfa:!1}):this.setState({showMfa:!0}))}))})),this.state={passwordError:"",confirmError:"",ldapPasswordError:"",serverError:""},this.ldapPasswordInput=m.createRef(),this.passwordInput=m.createRef(),this.passwordConfirmInput=m.createRef()}render(){let e=null,t="form-group";this.state.serverError&&(e=m.createElement("div",{className:"form-group has-error"},m.createElement("label",{className:"control-label"},this.state.serverError)),t+=" has-error");let a=null,r="form-group";this.state.passwordError&&(a=m.createElement("div",{className:"form-group has-error"},m.createElement("label",{className:"control-label"},this.state.passwordError)),r+=" has-error");let s=null,o="form-group";this.state.ldapPasswordError&&(s=m.createElement("div",{className:"form-group has-error"},m.createElement("label",{className:"control-label"},this.state.ldapPasswordError)),o+=" has-error");let l=null,n="form-group";this.state.confirmError&&(l=m.createElement("div",{className:"form-group has-error"},m.createElement("label",{className:"control-label"},this.state.confirmError)),n+=" has-error");const p=i._u("claim.ldap_to_email.ldapPwd","AD/LDAP Password");let c;return c=this.state.showMfa?m.createElement(v.Z,{loginId:this.props.email,password:this.state.password,submit:this.submit}):m.createElement("form",{onSubmit:this.preSubmit,className:t},m.createElement("p",null,m.createElement(h.Z,{id:"claim.ldap_to_email.email",defaultMessage:"After switching your authentication method, you will use {email} to login. Your AD/LDAP credentials will no longer allow access to MatterFOSS.",values:{email:this.props.email}})),m.createElement("p",null,m.createElement(h.Z,{id:"claim.ldap_to_email.enterLdapPwd",defaultMessage:"{ldapPassword}:",values:{ldapPassword:p}})),m.createElement("div",{className:o},m.createElement("input",{type:"password",className:"form-control",name:"ldapPassword",ref:this.ldapPasswordInput,placeholder:p,spellCheck:"false"})),s,m.createElement("p",null,m.createElement(h.Z,{id:"claim.ldap_to_email.enterPwd",defaultMessage:"New email login password:"})),m.createElement("div",{className:r},m.createElement(g.Z,{type:"password",className:"form-control",name:"password",ref:this.passwordInput,placeholder:{id:(0,E.t)("claim.ldap_to_email.pwd"),defaultMessage:"Password"},spellCheck:"false"})),a,m.createElement("div",{className:n},m.createElement(g.Z,{type:"password",className:"form-control",name:"passwordconfirm",ref:this.passwordConfirmInput,placeholder:{id:(0,E.t)("claim.ldap_to_email.confirm"),defaultMessage:"Confirm Password"},spellCheck:"false"})),l,m.createElement("button",{type:"submit",className:"btn btn-primary"},m.createElement(h.Z,{id:"claim.ldap_to_email.switchTo",defaultMessage:"Switch account to email/password"})),e),m.createElement("div",null,m.createElement("h3",null,m.createElement(h.Z,{id:"claim.ldap_to_email.title",defaultMessage:"Switch AD/LDAP Account to Email/Password"})),c)}}function M(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}N(S,"propTypes",{email:p().string,passwordConfig:p().object,switchLdapToEmail:p().func.isRequired}),a(73210);class C extends m.PureComponent{constructor(e){super(e),M(this,"preSubmit",(e=>{e.preventDefault();var t={passwordError:"",ldapError:"",ldapPasswordError:"",serverError:""};const a=this.emailPasswordInput.current&&this.emailPasswordInput.current.value;if(!a)return t.passwordError=i._u("claim.email_to_ldap.pwdError","Please enter your password."),void this.setState(t);const r=this.ldapIdInput.current&&this.ldapIdInput.current.value.trim();if(!r)return t.ldapError=i._u("claim.email_to_ldap.ldapIdError","Please enter your AD/LDAP ID."),void this.setState(t);const s=this.ldapPasswordInput.current&&this.ldapPasswordInput.current.value;if(!s)return t.ldapPasswordError=i._u("claim.email_to_ldap.ldapPasswordError","Please enter your AD/LDAP password."),void this.setState(t);t.password=a,t.ldapId=r,t.ldapPassword=s,this.setState(t),this.submit(this.props.email,a,"",r,s)})),M(this,"submit",((e,t,a,r,s)=>{(0,w.Is)(e,t,a,r||this.state.ldapId,s||this.state.ldapPassword,(e=>{e.follow_link&&(window.location.href=e.follow_link)}),(e=>{if(this.state.showMfa||"mfa.validate_token.authenticate.app_error"!==e.server_error_id)switch(e.id){case"ent.ldap.do_login.user_not_registered.app_error":case"ent.ldap.do_login.user_filtered.app_error":case"ent.ldap.do_login.matched_to_many_users.app_error":this.setState({ldapError:e.message,showMfa:!1});break;case"ent.ldap.do_login.invalid_password.app_error":this.setState({ldapPasswordError:e.message,showMfa:!1});break;case"api.user.check_user_password.invalid.app_error":this.setState({passwordError:e.message,showMfa:!1});break;default:this.setState({serverError:e.message,showMfa:!1})}else this.setState({showMfa:!0})}))})),this.state={passwordError:"",ldapError:"",ldapPasswordError:"",serverError:"",showMfa:!1},this.emailPasswordInput=m.createRef(),this.ldapIdInput=m.createRef(),this.ldapPasswordInput=m.createRef()}render(){let e=null,t="form-group";this.state.serverError&&(e=m.createElement("div",{className:"form-group has-error"},m.createElement("label",{className:"control-label"},this.state.serverError)),t+=" has-error");let a=null,r="form-group";this.state.passwordError&&(a=m.createElement("div",{className:"form-group has-error"},m.createElement("label",{className:"control-label"},this.state.passwordError)),r+=" has-error");let s=null,o="form-group";this.state.ldapError&&(s=m.createElement("div",{className:"form-group has-error"},m.createElement("label",{className:"control-label"},this.state.ldapError)),o+=" has-error");let l,n,p=null,c="form-group";return this.state.ldapPasswordError&&(p=m.createElement("div",{className:"form-group has-error"},m.createElement("label",{className:"control-label"},this.state.ldapPasswordError)),c+=" has-error"),l=this.props.ldapLoginFieldName?this.props.ldapLoginFieldName:i._u("claim.email_to_ldap.ldapId","AD/LDAP ID"),n=this.state.showMfa?m.createElement(v.Z,{loginId:this.props.email,password:this.state.password,submit:this.submit}):m.createElement("form",{onSubmit:this.preSubmit,className:t},m.createElement("p",null,m.createElement(h.Z,{id:"claim.email_to_ldap.ssoType",defaultMessage:"Upon claiming your account, you will only be able to login with AD/LDAP"})),m.createElement("p",null,m.createElement(h.Z,{id:"claim.email_to_ldap.ssoNote",defaultMessage:"You must already have a valid AD/LDAP account"})),m.createElement("p",null,m.createElement(h.Z,{id:"claim.email_to_ldap.enterPwd",defaultMessage:"Enter the password for your {site} email account",values:{site:this.props.siteName}})),m.createElement("input",{type:"text",style:I.usernameInput,name:"fakeusernameremembered"}),m.createElement("div",{className:r},m.createElement(g.Z,{type:"password",className:"form-control",name:"emailPassword",ref:this.emailPasswordInput,autoComplete:"off",placeholder:{id:(0,E.t)("claim.email_to_ldap.pwd"),defaultMessage:"Password"},spellCheck:"false"})),a,m.createElement("p",null,m.createElement(h.Z,{id:"claim.email_to_ldap.enterLdapPwd",defaultMessage:"Enter the ID and password for your AD/LDAP account"})),m.createElement("div",{className:o},m.createElement("input",{type:"text",className:"form-control",name:"ldapId",ref:this.ldapIdInput,autoComplete:"off",placeholder:l,spellCheck:"false"})),s,m.createElement("div",{className:c},m.createElement(g.Z,{type:"password",className:"form-control",name:"ldapPassword",ref:this.ldapPasswordInput,autoComplete:"off",placeholder:{id:(0,E.t)("claim.email_to_ldap.ldapPwd"),defaultMessage:"AD/LDAP Password"},spellCheck:"false"})),p,m.createElement("button",{type:"submit",className:"btn btn-primary"},m.createElement(h.Z,{id:"claim.email_to_ldap.switchTo",defaultMessage:"Switch Account to AD/LDAP"})),e),m.createElement("div",null,m.createElement("h3",null,m.createElement(h.Z,{id:"claim.email_to_ldap.title",defaultMessage:"Switch Email/Password Account to AD/LDAP"})),n)}}M(C,"propTypes",{email:p().string,siteName:p().string,ldapLoginFieldName:p().string});const I={usernameInput:{display:"none"}};class k extends m.PureComponent{render(){const e=new URLSearchParams(this.props.location.search).get("email"),t=new URLSearchParams(this.props.location.search).get("new_type"),a=new URLSearchParams(this.props.location.search).get("old_type");return m.createElement("div",null,m.createElement(u.Z,null),m.createElement("div",{className:"col-sm-12"},m.createElement("div",{className:"signup-team__container"},m.createElement("img",{alt:"signup logo",className:"signup-team-logo",src:d.Z}),m.createElement("div",{id:"claim"},m.createElement(c.rs,null,m.createElement(c.AW,{path:"".concat(this.props.match.url,"/oauth_to_email"),render:()=>m.createElement(b,{currentType:a,email:e,siteName:this.props.siteName,passwordConfig:this.props.passwordConfig})}),m.createElement(c.AW,{path:"".concat(this.props.match.url,"/email_to_oauth"),render:()=>m.createElement(y,{newType:t,email:e,siteName:this.props.siteName})}),m.createElement(c.AW,{path:"".concat(this.props.match.url,"/ldap_to_email"),render:()=>m.createElement(S,{email:e,passwordConfig:this.props.passwordConfig,switchLdapToEmail:this.props.actions.switchLdapToEmail})}),m.createElement(c.AW,{path:"".concat(this.props.match.url,"/email_to_ldap"),render:()=>m.createElement(C,{email:e,siteName:this.props.siteName,ldapLoginFieldName:this.props.ldapLoginFieldName})}))))))}}var Z,A,L;Z=k,A="propTypes",L={location:p().shape({search:p().string.isRequired}).isRequired,siteName:p().string,ldapLoginFieldName:p().string,passwordConfig:p().shape({minimumLength:p().number.isRequired,requireLowercase:p().bool.isRequired,requireUppercase:p().bool.isRequired,requireNumber:p().bool.isRequired,requireSymbol:p().bool.isRequired}),match:p().shape({url:p().string.isRequired}).isRequired,actions:p().shape({switchLdapToEmail:p().func.isRequired}).isRequired},A in Z?Object.defineProperty(Z,A,{value:L,enumerable:!0,configurable:!0,writable:!0}):Z[A]=L;const D=(0,r.connect)((function(e){const t=(0,l.iE)(e);return{siteName:t.SiteName,ldapLoginFieldName:t.LdapLoginFieldName,passwordConfig:(0,i.lD)(t)}}),(function(e){return{actions:(0,s.bindActionCreators)({switchLdapToEmail:o.jh},e)}}))(k)},96512:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var r=a(45697),s=a.n(r),o=(a(39714),a(67294)),l=a(44012),i=a(73727);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class p extends o.PureComponent{render(){return o.createElement("div",{id:"back_button",className:"signup-header"},o.createElement(i.Link,{onClick:this.props.onClick,to:this.props.url},o.createElement(l.Z,{id:"generic_icons.back",defaultMessage:"Back Icon"},(e=>o.createElement("span",{id:"back_button_icon",className:"fa fa-1x fa-angle-left",title:e.toString()}))),o.createElement(l.Z,{id:"web.header.back",defaultMessage:"Back"})))}}n(p,"propTypes",{url:s().string,onClick:s().func}),n(p,"defaultProps",{url:"/"})},6125:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d}),a(15306),a(73210);var r=a(45697),s=a.n(r),o=a(67294),l=a(44012),i=a(74935),n=a(82251),p=a(58657),m=a(927);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class d extends o.PureComponent{constructor(e){super(e),c(this,"handleChange",(e=>{e.preventDefault();const t=e.target.value.trim().replace(/\s/g,"");t!==this.state.token&&this.setState({token:t})})),c(this,"handleSubmit",(e=>{e.preventDefault();this.setState({serverError:"",saving:!0}),this.props.submit(this.props.loginId.toLowerCase(),this.props.password,this.state.token)})),this.state={saving:!1,token:"",serverError:""}}render(){let e,t="";return this.state.serverError&&(e=o.createElement("label",{className:"control-label"},this.state.serverError),t=" has-error"),o.createElement("form",{onSubmit:this.handleSubmit},o.createElement("div",{className:"signup__email-container"},o.createElement("p",null,o.createElement(l.Z,{id:"login_mfa.enterToken",defaultMessage:"To complete the sign in process, please enter a token from your smartphone's authenticator"})),o.createElement("div",{className:"form-group"+t},e),o.createElement("div",{className:"form-group"+t},o.createElement(m.Z,{type:"text",className:"form-control",name:"token",placeholder:{id:(0,n.t)("login_mfa.token"),defaultMessage:"MFA Token"},spellCheck:"false",autoComplete:"off",autoFocus:!0,onChange:this.handleChange})),o.createElement("div",{className:"form-group"},o.createElement(p.Z,{saving:this.state.saving,disabled:this.state.saving,onClick:this.handleSubmit,defaultMessage:(0,i._u)("login_mfa.submit","Submit"),savingMessage:(0,i._u)("login_mfa.submitting","Submitting...")}))))}}c(d,"propTypes",{loginId:s().string.isRequired,password:s().string.isRequired,submit:s().func.isRequired})},16406:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});const r=a.p+"files/a0a7d819869d6545c06500f0d8179b41.png"}}]);
//# sourceMappingURL=120.43fd4c9df76b5165b4f2.js.map