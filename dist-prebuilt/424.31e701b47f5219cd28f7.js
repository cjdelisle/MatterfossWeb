(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[424],{37979:(e,t,s)=>{"use strict";s.d(t,{x:()=>n,h:()=>a}),s(88674);var i=s(17214);function n(e,t,s){return n=>r(n(i.x4(e,t,s)))}function a(e,t,s){return n=>r(n(i.h8(e,t,s)))}async function r(e){let t=await e;return t.error&&"api.context.mfa_required.app_error"===t.error.server_error_id&&(t={data:!0}),t}},96512:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var i=s(45697),n=s.n(i),a=(s(39714),s(67294)),r=s(44012),o=s(73727);function l(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class c extends a.PureComponent{render(){return a.createElement("div",{id:"back_button",className:"signup-header"},a.createElement(o.Link,{onClick:this.props.onClick,to:this.props.url},a.createElement(r.Z,{id:"generic_icons.back",defaultMessage:"Back Icon"},(e=>a.createElement("span",{id:"back_button_icon",className:"fa fa-1x fa-angle-left",title:e.toString()}))),a.createElement(r.Z,{id:"web.header.back",defaultMessage:"Back"})))}}l(c,"propTypes",{url:n().string,onClick:n().func}),l(c,"defaultProps",{url:"/"})},37635:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var i=s(45697),n=s.n(i),a=s(67294),r=s(44012);function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class l extends a.PureComponent{render(){const{customDescriptionText:e,siteName:t}=this.props;let s=null;return s=e||a.createElement(r.Z,{id:"web.root.signup_info",defaultMessage:"All team communication in one place, searchable and accessible anywhere"}),a.createElement(a.Fragment,null,a.createElement("h1",{id:"site_name"},t),a.createElement("h4",{id:"site_description",className:"color--light"},s))}}o(l,"propTypes",{customDescriptionText:n().string,siteName:n().string}),o(l,"defaultProps",{siteName:"MatterFOSS"})},94424:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>G});var i=s(37703),n=s(14890),a=s(87271),r=s(26721),o=s(27457),l=s(94131),c=s(28823),d=s(37979),p=(s(15306),s(64765),s(73210),s(88674),s(33948),s(60285),s(4723),s(45697)),m=s.n(p),u=s(67294),g=s(44012),h=s(74806),E=s(73727),f=s(80801),b=s(34288),S=s(24493),v=s(89262),N=s(78274),_=s(72654),I=s(74935),w=s(18402),x=s(82251),U=s(16406),L=s(37635),Z=s(47130),C=s(95795),P=s(45288),k=s(96512),y=s(19476),M=s(21843),T=s(20608),R=s(37668),W=s(927),O=s(64852),B=s(6125);function D(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class q extends u.PureComponent{constructor(e){super(e),D(this,"configureTitle",(()=>{this.state.sessionExpired?document.title=this.props.intl.formatMessage({id:"login.session_expired.title",defaultMessage:"* {siteName} - Session Expired"},{siteName:this.props.siteName}):document.title=this.props.siteName})),D(this,"showSessionExpiredNotificationIfNeeded",(()=>{this.state.sessionExpired&&!this.closeSessionExpiredNotification?(0,w.c)({title:this.props.siteName,body:I._u("login.session_expired.notification","Session Expired: Please sign in to continue receiving notifications."),requireInteraction:!0,silent:!1,onClick:()=>{window.focus(),this.closeSessionExpiredNotification()&&(this.closeSessionExpiredNotification(),this.closeSessionExpiredNotification=null)}}).then((e=>{this.closeSessionExpiredNotification=e})).catch((()=>{})):!this.state.sessionExpired&&this.closeSessionExpiredNotification&&(this.closeSessionExpiredNotification(),this.closeSessionExpiredNotification=null)})),D(this,"preSubmit",(e=>{e.preventDefault(),this.onDismissSessionExpired();const{location:t}=this.props,s=t.search.replace(/(extra=password_change)&?/i,"");s!==t.search&&v.m.replace("".concat(t.pathname).concat(s).concat(t.hash));let i=this.state.loginId;this.loginIdInput.current&&(i=this.loginIdInput.current.value,i!==this.state.loginId&&this.setState({loginId:i}));let n=this.state.password;if(this.passwordInput.current&&(n=this.passwordInput.current.value,n!==this.state.password&&this.setState({password:n})),i=i.trim().toLowerCase(),!i){(0,x.t)("login.noEmail"),(0,x.t)("login.noEmailLdapUsername"),(0,x.t)("login.noEmailUsername"),(0,x.t)("login.noEmailUsernameLdapUsername"),(0,x.t)("login.noLdapUsername"),(0,x.t)("login.noUsername"),(0,x.t)("login.noUsernameLdapUsername");let e="login.no";return this.state.emailSigninEnabled&&(e+="Email"),this.state.usernameSigninEnabled&&(e+="Username"),this.state.ldapEnabled&&(e+="LdapUsername"),void this.setState({serverError:u.createElement(g.Z,{id:e,values:{ldapUsername:this.props.ldapLoginFieldName||I._u("login.ldapUsernameLower","AD/LDAP username")}})})}n?this.submit(i,n,""):this.setState({serverError:u.createElement(g.Z,{id:"login.noPassword",defaultMessage:"Please enter your password"})})})),D(this,"submit",((e,t,s)=>{this.setState({serverError:null,loading:!0}),this.props.actions.login(e,t,s).then((async({error:t})=>{if(t)return void("api.user.login.not_verified.app_error"===t.server_error_id?v.m.push("/should_verify_email?&email="+encodeURIComponent(e)):"store.sql_user.get_for_login.app_error"===t.server_error_id||"ent.ldap.do_login.user_not_registered.app_error"===t.server_error_id?this.setState({showMfa:!1,loading:!1,serverError:u.createElement(g.Z,{id:"login.userNotFound",defaultMessage:"We couldn't find an account matching your login credentials."})}):"api.user.check_user_password.invalid.app_error"===t.server_error_id||"ent.ldap.do_login.invalid_password.app_error"===t.server_error_id?this.setState({showMfa:!1,loading:!1,serverError:u.createElement(g.Z,{id:"login.invalidPassword",defaultMessage:"Your password is incorrect."})}):this.state.showMfa||"mfa.validate_token.authenticate.app_error"!==t.server_error_id?this.setState({showMfa:!1,serverError:t.message,loading:!1}):this.setState({showMfa:!0}));const s=new URLSearchParams(this.props.location.search),i=s.get("t")||"",n=s.get("id")||"";if(n||i){const{data:e}=await this.props.actions.addUserToTeamFromInvite(i,n);e?this.finishSignin(e):this.finishSignin()}else this.finishSignin()}))})),D(this,"finishSignin",(e=>{const t=this.props.experimentalPrimaryTeam,s=new URLSearchParams(this.props.location.search).get("redirect_to");I.ow(),S.Z.setWasLoggedIn(!0),s&&s.match(/^\/([^/]|$)/)?v.m.push(s):e?v.m.push("/".concat(e.name)):t?v.m.push("/".concat(t)):b.mc()})),D(this,"handleLoginIdChange",(e=>{this.setState({loginId:e.target.value})})),D(this,"handlePasswordChange",(e=>{this.setState({password:e.target.value})})),D(this,"handleBrandImageError",(()=>{this.setState({brandImageError:!0})})),D(this,"createCustomLogin",(()=>{if(this.props.enableCustomBrand){const e=this.props.customBrandText||"",t=f.je.getBrandImageUrl(0),s=this.state.brandImageError?{display:"none"}:{};return u.createElement("div",null,u.createElement("img",{alt:"brand image",src:t,onError:this.handleBrandImageError,style:s}),u.createElement("div",null,u.createElement(O.Z,{message:e,options:{mentions:!1,imagesMetadata:null}})))}return null})),D(this,"createLoginPlaceholder",(()=>{const e=this.state.ldapEnabled,t=this.state.usernameSigninEnabled,s=[];return this.state.emailSigninEnabled&&s.push(I._u("login.email","Email")),t&&s.push(I._u("login.username","Username")),e&&(this.props.ldapLoginFieldName?s.push(this.props.ldapLoginFieldName):s.push(I._u("login.ldapUsername","AD/LDAP Username"))),s.length>=2?s.slice(0,s.length-1).join(", ")+I._u("login.placeholderOr"," or ")+s[s.length-1]:1===s.length?s[0]:""})),D(this,"checkSignUpEnabled",(()=>this.props.enableSignUpWithEmail||this.props.enableSignUpWithGitLab||this.props.enableSignUpWithOffice365||this.props.enableSignUpWithGoogle||this.props.enableSignUpWithOpenId||this.props.enableLdap||this.props.enableSaml)),D(this,"onDismissSessionExpired",(()=>{S.Z.setWasLoggedIn(!1),this.setState({sessionExpired:!1})})),D(this,"createExtraText",(()=>{const e=new URLSearchParams(this.props.location.search).get("extra");return this.state.sessionExpired?u.createElement("div",{className:"alert alert-warning"},u.createElement(R.Z,null)," ",u.createElement(g.Z,{id:"login.session_expired",defaultMessage:"Your session has expired. Please log in again."})," ",u.createElement(E.Link,{className:"btn-close",to:"/login",onClick:this.onDismissSessionExpired},u.createElement("span",null,"Ã—"))):e===N.ZP.GET_TERMS_ERROR?u.createElement("div",{className:"alert has-error no-padding"},u.createElement("label",{className:"control-label"},u.createElement(g.Z,{id:"login.get_terms_error",defaultMessage:"Unable to load terms of service. If this issue persists, contact your System Administrator."}))):e===N.ZP.TERMS_REJECTED?u.createElement("div",{className:"alert alert-warning"},u.createElement(R.Z,null),u.createElement(P.Z,{id:"login.terms_rejected",defaultMessage:"You must agree to the terms of service before accessing {siteName}. Please contact your System Administrator for more details.",values:{siteName:this.props.siteName}})):e===N.ZP.SIGNIN_CHANGE?u.createElement("div",{className:"alert alert-success"},u.createElement(T.Z,null),u.createElement(g.Z,{id:"login.changed",defaultMessage:" Sign-in method changed successfully"})):e===N.ZP.SIGNIN_VERIFIED?u.createElement("div",{className:"alert alert-success"},u.createElement(T.Z,null),u.createElement(g.Z,{id:"login.verified",defaultMessage:" Email Verified"})):e===N.ZP.PASSWORD_CHANGE?u.createElement("div",{id:"passwordUpdatedSuccess",className:"alert alert-success"},u.createElement(T.Z,null),u.createElement(g.Z,{id:"login.passwordChanged",defaultMessage:" Password updated successfully"})):e===N.ZP.CREATE_LDAP?u.createElement("div",{className:"alert alert-grey"},u.createElement(g.Z,{id:"login.ldapCreate",defaultMessage:" Enter your AD/LDAP username and password to create an account."})):null})),D(this,"createLoginOptions",(()=>{const e=[],t=this.state.ldapEnabled,s=this.props.enableSignUpWithGitLab,i=this.props.enableSignUpWithGoogle,n=this.props.enableSignUpWithOffice365,a=this.props.enableSignUpWithOpenId,r=this.state.samlEnabled,o=this.state.usernameSigninEnabled,l=this.state.emailSigninEnabled;if(l||o||t){let t="";this.state.serverError&&(t=" has-error"),e.push(u.createElement("form",{key:"loginBoxes",onSubmit:this.preSubmit},u.createElement("div",{className:"signup__email-container"},u.createElement(C.Z,{error:this.state.serverError,margin:!0}),u.createElement("div",{className:"form-group"+t},u.createElement("input",{id:"loginId",className:"form-control",ref:this.loginIdInput,name:"loginId",value:this.state.loginId,onChange:this.handleLoginIdChange,placeholder:this.createLoginPlaceholder(),spellCheck:"false",autoCapitalize:"off",autoFocus:!0})),u.createElement("div",{className:"form-group"+t},u.createElement(W.Z,{id:"loginPassword",type:"password",className:"form-control",ref:this.passwordInput,name:"password",value:this.state.password,onChange:this.handlePasswordChange,placeholder:{id:(0,x.t)("login.password"),defaultMessage:"Password"},spellCheck:"false"})),u.createElement("div",{className:"form-group"},u.createElement("button",{id:"loginButton",type:"submit",className:"btn btn-primary"},u.createElement(M.Z,{id:"login_button_signing",loading:this.state.loading,text:I._u("login.signInLoading","Signing in...")},u.createElement(g.Z,{id:"login.signIn",defaultMessage:"Sign in"})))))))}if(this.props.enableOpenServer&&this.checkSignUpEnabled()&&e.push(u.createElement("div",{className:"form-group",key:"signup"},u.createElement("span",null,u.createElement(g.Z,{id:"login.noAccount",defaultMessage:"Don't have an account? "}),u.createElement(E.Link,{id:"signup",to:"/signup_user_complete"+this.props.location.search,className:"signup-team-login"},u.createElement(g.Z,{id:"login.create",defaultMessage:"Create one now"}))))),(o||l)&&e.push(u.createElement("div",{id:"login_forgot",key:"forgotPassword",className:"form-group"},u.createElement(E.Link,{to:"/reset_password"},u.createElement(g.Z,{id:"login.forgot",defaultMessage:"I forgot my password."})))),(l||o||t)&&(s||i||r||n||a)&&(e.push(u.createElement("div",{key:"divider",className:"or__container"},u.createElement(g.Z,{id:"login.or",defaultMessage:"or"}))),e.push(u.createElement("h5",{key:"oauthHeader"},u.createElement(g.Z,{id:"login.signInWith",defaultMessage:"Sign in with:"})))),s&&e.push(u.createElement("a",{id:"GitLabButton",className:"btn btn-custom-login gitlab",key:"gitlab",href:f.je.getOAuthRoute()+"/gitlab/login"+this.props.location.search},u.createElement("span",null,u.createElement("span",{className:"icon"}),u.createElement("span",null,u.createElement(g.Z,{id:"login.gitlab",defaultMessage:"GitLab"}))))),i&&e.push(u.createElement("a",{id:"GoogleButton",className:"btn btn-custom-login google",key:"google",href:f.je.getOAuthRoute()+"/google/login"+this.props.location.search},u.createElement("span",null,u.createElement("span",{className:"icon"}),u.createElement("span",null,u.createElement(g.Z,{id:"login.google",defaultMessage:"Google Apps"}))))),n&&e.push(u.createElement("a",{id:"Office365Button",className:"btn btn-custom-login office365",key:"office365",href:f.je.getOAuthRoute()+"/office365/login"+this.props.location.search},u.createElement("span",null,u.createElement("span",{className:"icon"}),u.createElement("span",null,u.createElement(g.Z,{id:"login.office365",defaultMessage:"Office 365"}))))),a){const t={};this.props.openidButtonColor&&(t.backgroundColor=this.props.openidButtonColor);let s=u.createElement(g.Z,{id:"login.openid",defaultMessage:"Open ID"});this.props.openidButtonText&&(s=this.props.openidButtonText),e.push(u.createElement("a",{id:"OpenIdButton",className:"btn btn-custom-login openid",style:t,key:"openid",href:f.je.getOAuthRoute()+"/openid/login"+this.props.location.search},u.createElement("span",null,u.createElement("span",null,s))))}return r&&e.push(u.createElement("a",{className:"btn btn-custom-login saml",key:"saml",href:f.je.getUrl()+"/login/sso/saml"+this.props.location.search},u.createElement("span",null,u.createElement("span",{className:"icon fa fa-lock fa--margin-top",title:"Saml icon"}),u.createElement("span",null,this.props.samlLoginButtonText)))),0===e.length&&e.push(u.createElement(C.Z,{key:"noMethods",error:u.createElement(g.Z,{id:"login.noMethods",defaultMessage:"No sign-in methods are enabled. Please contact your System Administrator."}),margin:!0})),u.createElement("div",null,this.createExtraText(),e)})),D(this,"hideMfa",(()=>{this.setState({showMfa:!1})}));let t="";new URLSearchParams(this.props.location.search).get("extra")===N.ZP.SIGNIN_VERIFIED&&new URLSearchParams(this.props.location.search).get("email")&&(t=new URLSearchParams(this.props.location.search).get("email")),this.state={ldapEnabled:this.props.isLicensed&&this.props.enableLdap,usernameSigninEnabled:this.props.enableSignInWithUsername,emailSigninEnabled:this.props.enableSignInWithEmail,samlEnabled:this.props.isLicensed&&this.props.enableSaml,loginId:t,password:"",showMfa:!1,loading:!1,sessionExpired:!1,brandImageError:!1},this.loginIdInput=u.createRef(),this.passwordInput=u.createRef()}componentDidMount(){if(this.configureTitle(),this.props.currentUser)return void b.mc();const e=new URLSearchParams(this.props.location.search),t=e.get("extra"),s=e.get("email");var i;t===N.ZP.SIGNIN_VERIFIED&&s&&(null===(i=this.passwordInput.current)||void 0===i||i.focus()),S.Z.getWasLoggedIn()&&(t===N.ZP.SIGNIN_CHANGE?S.Z.setWasLoggedIn(!1):(this.setState({sessionExpired:!0}),e.set("extra",N.ZP.SESSION_EXPIRED),v.m.replace("".concat(this.props.location.pathname,"?").concat(e)))),this.showSessionExpiredNotificationIfNeeded()}componentDidUpdate(){this.configureTitle(),this.showSessionExpiredNotificationIfNeeded()}componentWillUnmount(){this.closeSessionExpiredNotification&&(this.closeSessionExpiredNotification(),this.closeSessionExpiredNotification=null)}render(){const{customDescriptionText:e,siteName:t,initializing:s}=this.props;if(s)return u.createElement(y.Z,null);let i,n,a,r;return this.state.showMfa?(i=u.createElement(B.Z,{loginId:this.state.loginId,password:this.state.password,submit:this.submit}),r=u.createElement(k.Z,{onClick:this.hideMfa})):(i=this.createLoginOptions(),n=this.createCustomLogin(),n&&(a="branded")),u.createElement("div",null,u.createElement(Z.Z,null),r,u.createElement("div",{id:"login_section",className:"col-sm-12"},u.createElement("div",{className:"signup-team__container "+a},u.createElement("div",{className:"signup__markdown"},n),u.createElement("img",{alt:"signup team logo",className:"signup-team-logo",src:U.Z}),u.createElement("div",{className:"signup__content"},u.createElement(L.Z,{customDescriptionText:e,siteName:t}),i))))}}D(q,"propTypes",{intl:_.gm.isRequired,location:m().object.isRequired,isLicensed:m().bool.isRequired,currentUser:m().object,customBrandText:m().string,customDescriptionText:m().string,enableCustomBrand:m().bool.isRequired,enableLdap:m().bool.isRequired,enableOpenServer:m().bool.isRequired,enableSaml:m().bool.isRequired,enableSignInWithEmail:m().bool.isRequired,enableSignInWithUsername:m().bool.isRequired,enableSignUpWithEmail:m().bool.isRequired,enableSignUpWithGitLab:m().bool.isRequired,enableSignUpWithGoogle:m().bool.isRequired,enableSignUpWithOffice365:m().bool.isRequired,enableSignUpWithOpenId:m().bool.isRequired,experimentalPrimaryTeam:m().string,ldapLoginFieldName:m().string,samlLoginButtonText:m().string,openidButtonText:m().string,openidButtonColor:m().string,siteName:m().string,initializing:m().bool,actions:m().shape({login:m().func.isRequired,addUserToTeamFromInvite:m().func.isRequired}).isRequired});const A=(0,h.ZP)(q),G=(0,i.connect)((function(e){const t=(0,a.iE)(e),s="true"===(0,a.lJ)(e).IsLicensed,i=t.CustomBrandText,n=t.CustomDescriptionText,c="true"===t.EnableCustomBrand,d="true"===t.EnableLdap,p="true"===t.EnableOpenServer,m="true"===t.EnableSaml,u="true"===t.EnableSignInWithEmail,g="true"===t.EnableSignInWithUsername,h="true"===t.EnableSignUpWithEmail,E="true"===t.EnableSignUpWithGitLab,f="true"===t.EnableSignUpWithGoogle,b="true"===t.EnableSignUpWithOffice365,S="true"===t.EnableSignUpWithOpenId,v=t.LdapLoginFieldName,N=t.SamlLoginButtonText,_=t.OpenIdButtonText,I=t.OpenIdButtonColor,w=t.SiteName,x=e.requests.users.logout.status===l.eE.SUCCESS||!e.storage.initialized;let U=t.ExperimentalPrimaryTeam;if(U){const t=(0,r.Xv)(e,U);if(t){const s=(0,r.kQ)(e,t.id);s&&s.team_id||(U=null)}else U=null}return{currentUser:(0,o.ts)(e),isLicensed:s,customBrandText:i,customDescriptionText:n,enableCustomBrand:c,enableLdap:d,enableOpenServer:p,enableSaml:m,enableSignInWithEmail:u,enableSignInWithUsername:g,enableSignUpWithEmail:h,enableSignUpWithGitLab:E,enableSignUpWithGoogle:f,enableSignUpWithOffice365:b,enableSignUpWithOpenId:S,experimentalPrimaryTeam:U,ldapLoginFieldName:v,samlLoginButtonText:N,openidButtonText:_,openidButtonColor:I,siteName:w,initializing:x}}),(function(e){return{actions:(0,n.bindActionCreators)({login:d.x,addUserToTeamFromInvite:c.UI},e)}}))(A)},6125:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m}),s(15306),s(73210);var i=s(45697),n=s.n(i),a=s(67294),r=s(44012),o=s(74935),l=s(82251),c=s(58657),d=s(927);function p(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class m extends a.PureComponent{constructor(e){super(e),p(this,"handleChange",(e=>{e.preventDefault();const t=e.target.value.trim().replace(/\s/g,"");t!==this.state.token&&this.setState({token:t})})),p(this,"handleSubmit",(e=>{e.preventDefault();this.setState({serverError:"",saving:!0}),this.props.submit(this.props.loginId.toLowerCase(),this.props.password,this.state.token)})),this.state={saving:!1,token:"",serverError:""}}render(){let e,t="";return this.state.serverError&&(e=a.createElement("label",{className:"control-label"},this.state.serverError),t=" has-error"),a.createElement("form",{onSubmit:this.handleSubmit},a.createElement("div",{className:"signup__email-container"},a.createElement("p",null,a.createElement(r.Z,{id:"login_mfa.enterToken",defaultMessage:"To complete the sign in process, please enter a token from your smartphone's authenticator"})),a.createElement("div",{className:"form-group"+t},e),a.createElement("div",{className:"form-group"+t},a.createElement(d.Z,{type:"text",className:"form-control",name:"token",placeholder:{id:(0,l.t)("login_mfa.token"),defaultMessage:"MFA Token"},spellCheck:"false",autoComplete:"off",autoFocus:!0,onChange:this.handleChange})),a.createElement("div",{className:"form-group"},a.createElement(c.Z,{saving:this.state.saving,disabled:this.state.saving,onClick:this.handleSubmit,defaultMessage:(0,o._u)("login_mfa.submit","Submit"),savingMessage:(0,o._u)("login_mfa.submitting","Submitting...")}))))}}p(m,"propTypes",{loginId:n().string.isRequired,password:n().string.isRequired,submit:n().func.isRequired})},16406:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i=s.p+"files/37ecfc86d48a22a44e9c13bb44bc7425.png"}}]);
//# sourceMappingURL=424.31e701b47f5219cd28f7.js.map